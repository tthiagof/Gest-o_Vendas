<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Clientes</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-gray-200">

<!-- HEADER -->
<header class="w-full bg-gray-800 shadow-md px-6 py-4 flex justify-between items-center">
    <div class="flex items-center gap-4">
        <button onclick="toggleSidebar()" class="text-white text-2xl">â˜°</button>
        <h1 class="text-xl md:text-2xl font-semibold">Sistema de GestÃ£o</h1>
    </div>

    <div class="flex items-center gap-4">
        <nav class="hidden md:flex gap-4 text-gray-400">
            <a href="#" class="hover:text-white transition">ConfiguraÃ§Ãµes</a>
            <a href="#" class="hover:text-white transition">Perfil</a>
        </nav>
        <img src="/assets/profile.jpg"
             alt="Perfil"
             class="w-10 h-10 rounded-full object-cover border border-gray-600">
    </div>
</header>

<!-- SIDEBAR -->
<aside id="sidebar"
    class="fixed top-0 left-0 h-full w-64 bg-gray-900 transform -translate-x-full transition-transform duration-300 z-50">
    
    <div class="p-6 text-xl font-semibold border-b border-gray-700">
        Menu
    </div>

    <nav class="flex flex-col p-4 gap-3 text-gray-400">
        <a href="#" class="hover:text-white">ğŸ“¦ Entrada de Produtos</a>
        <a href="#" class="hover:text-white">ğŸšš SaÃ­da de Produtos</a>
        <a href="#" class="hover:text-white">ğŸ” Consulta de Estoque</a>
        <a href="#" class="hover:text-white">ğŸ§¾ InventÃ¡rio</a>
        <a href="/dashboard/vendas" class="hover:text-white">ğŸ’µ Vendas</a>
        <a href="#" class="hover:text-white">ğŸ“œ HistÃ³rico de Vendas</a>
        <a href="/dashboard/addproduts" class="hover:text-white font-medium">ğŸ·ï¸ Produtos</a>
        <a href="/dashboard/gerenclientes" class="hover:text-white font-medium">ğŸ‘¥ Clientes</a>
        <a href="#" class="hover:text-white">ğŸ“Š RelatÃ³rios</a>
        <a href="#" class="hover:text-white">âš™ï¸ ConfiguraÃ§Ãµes</a>
    </nav>
</aside>

<div id="overlay"
     onclick="toggleSidebar()"
     class="fixed inset-0 bg-black bg-opacity-50 hidden z-40">
</div>

<main id="mainContent" class="p-6 transition-all duration-300">
<div class="max-w-6xl mx-auto">

<div class="flex justify-between items-center mb-8">
    <h2 class="text-3xl font-semibold">
        Gerenciamento de Clientes
    </h2>
    
    <button onclick="toggleAddForm()"
        class="bg-blue-600 hover:bg-blue-700 px-5 py-2 rounded-xl font-semibold shadow">
        â• Adicionar Cliente
    </button>
</div>

<div class="mb-6">
    <input
        id="searchById"
        type="number"
        placeholder="Buscar cliente pelo ID"
        class="w-full md:w-1/3 p-3 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600"
        oninput="filterById()"
    >
</div>

<section id="addForm" class="hidden bg-gray-800 p-6 rounded-2xl shadow mb-10">
<h3 class="text-xl font-semibold mb-6 text-center">
    Novo Cliente
</h3>

<!-- âœ… ALTERADO: action -->
<form method="POST" action="/dashboard/gerenclientes/add"
      class="grid grid-cols-1 md:grid-cols-2 gap-5">

    <input name="nome" placeholder="Nome"
        class="p-3 rounded bg-gray-900 border border-gray-700">
    <input name="numero" placeholder="Telefone"
        class="p-3 rounded bg-gray-900 border border-gray-700">
    <input name="email" placeholder="Email"
        class="p-3 rounded bg-gray-900 border border-gray-700">
    <input name="cpf" placeholder="CPF"
        class="p-3 rounded bg-gray-900 border border-gray-700">

    <button
        class="md:col-span-2 bg-blue-600 hover:bg-blue-700 py-3 rounded-xl font-semibold">
        Salvar Cliente
    </button>
</form>
</section>

<section class="grid gap-4">

<% if (clientes && clientes.length > 0) { %>
<% clientes.forEach(cliente => { %>

<div class="cliente-item bg-gray-800 p-5 rounded-xl shadow flex flex-col md:flex-row md:items-center md:justify-between gap-4"
    data-id="<%= cliente.id %>">

<div>
    <p class="text-lg font-semibold">
        <%= cliente.nome %>
        <% if (!cliente.ativo) { %>
            <span class="text-red-500 text-sm ml-2">(Inativo)</span>
        <% } %>
    </p>
    <p class="text-sm text-gray-400">ID:<%= cliente.id %></p>
    <p class="text-sm text-gray-400"><%= cliente.email %></p>
    <p class="text-sm text-gray-400"><%= cliente.numero %></p>
</div>

<button onclick="toggleEdit('<%= cliente.id %>')"
    class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg font-medium">
    âœï¸ Editar
</button>
</div>

<div id="edit-<%= cliente.id %>" class="hidden bg-gray-900 p-6 rounded-xl border border-gray-700">

<!-- âœ… ALTERADO: update -->
<form method="POST"
      action="/dashboard/gerenclientes/update/<%= cliente.id %>"
      class="grid grid-cols-1 md:grid-cols-2 gap-4">

    <label class="block text-gray-700 dark:text-gray-300 mb-1">Nome</label>
    <input name="nome" value="<%= cliente.nome %>"
        class="p-3 rounded bg-gray-800 border border-gray-700">

    <label class="block text-gray-700 dark:text-gray-300 mb-1">Email</label>
    <input name="email" value="<%= cliente.email %>"
        class="p-3 rounded bg-gray-800 border border-gray-700">

    <label class="block text-gray-700 dark:text-gray-300 mb-1">NÃºmero</label>
    <input name="numero" value="<%= cliente.numero %>"
        class="p-3 rounded bg-gray-800 border border-gray-700">

    <div class="md:col-span-2">
        <button
            class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded font-semibold">
            Salvar AlteraÃ§Ãµes
        </button>
    </div>
</form>

<!-- âœ… ALTERADO: delete separado -->
<form method="POST"
      action="/dashboard/gerenclientes/delete/<%= cliente.id %>"
      class="mt-3">

    <button
        class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded font-semibold">
        Inativar Cliente
    </button>
</form>

</div>

<% }) %>
<% } else { %>
<p class="text-center text-gray-400">
    Nenhum cliente cadastrado.
</p>
<% } %>

</section>
</div>
</main>

<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const mainContent = document.getElementById('mainContent');

    if (sidebar.classList.contains('-translate-x-full')) {
        sidebar.classList.remove('-translate-x-full');
        overlay.classList.remove('hidden');
        mainContent.classList.add('ml-64');
    } else {
        sidebar.classList.add('-translate-x-full');
        overlay.classList.add('hidden');
        mainContent.classList.remove('ml-64');
    }
}

function toggleAddForm() {
    document.getElementById('addForm').classList.toggle('hidden');
}

function toggleEdit(id) {
    document.getElementById(`edit-${id}`).classList.toggle('hidden');
}

function filterById() {
    const searchValue = document.getElementById('searchById').value;
    document.querySelectorAll('.cliente-item').forEach(cliente => {
        const id = cliente.getAttribute('data-id');
        cliente.style.display =
            searchValue === '' || id.includes(searchValue)
            ? 'flex'
            : 'none';
    });
}
</script>

</body>
</html>
